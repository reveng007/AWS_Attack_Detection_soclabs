# 4. SOCLabs: Retrieving a High Number of AWS Secrets Manager Secrets

From here: https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_Operations.html

## Detailed Reasoning :

```yaml
title: Identify abnormal Secrets Manager secret retrieval activities
status: test
description: Identify abnormal Secrets Manager secret retrieval activities
references:
    - https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_GetSecretValue.html
    - https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_BatchGetSecretValue.html
    - https://docs.aws.amazon.com/secretsmanager/latest/userguide/manage_search-secret.html
    - https://docs.aws.amazon.com/secretsmanager/latest/apireference/API_ListSecrets.html
author: Soumyanil Biswas
date: 2025-10-14
modified: 2025-10-14
tags:
    - attack.credential-access
    - attack.xxxx
logsource:
    product: aws
    service: cloudtrail
detection:
    selection:
        eventSource: secretsmanager.amazonaws.com
        eventType: AwsApiCall

        # Retrieves the contents of the encrypted fields SecretString or SecretBinary from the specified version of a secret, whichever contains content.
        eventName: GetSecretValue

        # Retrieves the contents of the encrypted fields SecretString or SecretBinary for up to 20 secrets.
        eventName: BatchGetSecretValue

        # Lists the secrets that are stored by Secrets Manager in the AWS account
        eventName: ListSecrets

        # Have to add timing here in Sigma (Just like KQL, Splunk) ...

    condition: selection 
falsepositives:
    - unknown
level: high
fields:
    - eventName
    - sourceIPAddress
    - eventID
    - eventSource
    - userIdentity.arn
    - sourceIPAddress
```
