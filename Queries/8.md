# 8.SOCLabs: CloudTrail Logs Impairment Through S3 Lifecycle Rule

url: https://www.soc-labs.top/en/detections/88

## Detailed Reasoning :

1. Searched here: https://docs.aws.amazon.com/ (for: `S3`)
2. Searched here: https://docs.aws.amazon.com/AmazonS3/latest/API/API_Operations.html (for: `cycle`)
3. Jotted down links:
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLifecycle.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLifecycleConfiguration.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycle.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycleConfiguration.html

## Sigma Query:

```yaml
title: AWS Deletes a trail
status: test
description: AWS Deletes a trail
references:
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLifecycle.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetBucketLifecycleConfiguration.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycle.html
    - https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLifecycleConfiguration.html
author: Soumyanil Biswas
date: 2025-10-15
modified: 2025-10-15
tags:
    - attack.xxxx
logsource:
    product: aws
    service: cloudtrail
detection:
    selection:
        eventSource: s3.amazonaws.com
        eventType: AwsApiCall
        
        #eventName: GetBucketLifecycle
        #eventName: GetBucketLifecycleConfiguration
        
        eventName: PutBucketLifecycle
        #eventName: PutBucketLifecycleConfiguration

        requestParameters.LifecycleConfiguration.Rule.Expiration.Days: 1
        
    condition: selection 
falsepositives:
    - unknown
level: high
fields:
    - eventName
    - sourceIPAddress
    - eventID
    - eventSource
    - userIdentity.arn``
```
